<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Log in</title>
</head>
<body>
    <div id="root">
			<h1>Please login first!</h1>
			<h2 id="info"></h2>
			<form>
				<div>
					<input id="username" type="text">
				</div>
				<div>
					<input id="password" type="password">
				</div>
				<div>
					<button id="btn_login" type="button">log in</button>
				</div>
			</form>
		</div>
		<script>
			const loginBtn = document.getElementById("btn_login")
			const root = document.getElementById("root")
			const info = document.getElementById("info")
		
			loginBtn.onclick = () => {
				const username = document.getElementById("username").value.trim()
				const password = document.getElementById("password").value.trim()
				//调用fetch发送请求完成登录
				fetch("http://localhost:3000/login",{
						method:"POST",
						headers:{
							"Content-type":"application/json",
						},
						body: JSON.stringify({username,password})
				})
				.then(res=>res.json())
				.then(res=>{
					if(res.status !== "ok"){
						throw new Error("username or password is not correct.")
					}
					root.innerHTML = `
						<h1>${res.data.nickname}, welcome back!</h1>
						<hr>
						<button id="btn_load">Load data</button>
					`
				})
				.catch(err=>{
					console.log("chu cuo le,", err)
					document.getElementById("info").innerText = "username or password is not correct."
				})
			}
		</script>
</body>
</html>